FROM n8nio/n8n:1.85.4


USER root


COPY n8n-nodes-random /home/node/.n8n/custom/n8n-nodes-random
WORKDIR /home/node/.n8n/custom/n8n-nodes-random


ENV NODE_ENV=development
RUN npm install && npm run build || true


RUN chown -R node:node /home/node/.n8n/custom/n8n-nodes-random
USER node


ENV N8N_CUSTOM_EXTENSIONS=/home/node/.n8n/custom